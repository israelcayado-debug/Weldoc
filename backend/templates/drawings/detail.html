{% extends "base.html" %}

{% block content %}
  <h1>Drawing {{ item.code }}</h1>
  <p>Project: {{ item.project }}</p>
  <p>
    Equipment:
    {% if item.equipment %}
      {{ item.equipment.name }}
    {% endif %}
  </p>
  <p>Revision: {{ item.revision }}</p>
  <p>
    File:
    {% if item.file_path %}
      <a href="/media/{{ drawing_file_url }}">{{ item.file_path }}</a>
    {% else %}
      -
    {% endif %}
  </p>
  <p>
    <a href="/ui/welds/drawings/{{ item.id }}/edit/">Edit</a> |
    <a href="/ui/welds/drawings/{{ item.id }}/new-revision/">New revision</a> |
    {% if weld_map %}
      <a href="/ui/welds/weld-maps/{{ weld_map.id }}/">Open welding map</a> |
    {% else %}
      <a href="/ui/welds/weld-maps/new/?project_id={{ item.project.id }}&drawing_id={{ item.id }}">Create welding map</a> |
    {% endif %}
    <a href="/ui/welds/drawings/">Back</a>
  </p>

  <h2>Revisions</h2>
  <ul>
    {% for rev in revisions %}
      <li>
        <a href="/ui/welds/drawings/{{ rev.id }}/">{{ rev.revision }}</a>
        {% if rev.id == item.id %}(current){% endif %}
        {% if rev.id != item.id %}
          <form method="post" action="/ui/welds/drawings/{{ item.id }}/copy-marks/" style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="source_id" value="{{ rev.id }}">
            <button type="submit">Copy marks</button>
          </form>
        {% endif %}
      </li>
    {% empty %}
      <li>No revisions.</li>
    {% endfor %}
  </ul>
{% endblock %}
